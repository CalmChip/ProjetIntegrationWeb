<section>
  <div class="bg-primary text-white text-center">
    <div class="d-flex justify-content-between">
      <img
        src="/pictures/logo.jpg"
        alt="Logo"
        style="
          padding: 10px;
          max-height: 85px;
          border-radius: 15px;
          align-self: center;
        "
      />
      <h3 style="margin-top: auto; margin-bottom: auto">Better Admin</h3>
      <img
        src="/pictures/proudly_canadian.png"
        alt="proudly_canadian"
        style="
          padding: 10px;
          min-width: 11rem;
          max-height: 75px;
          align-self: center;
          margin-right: 10px;
        "
      />
    </div>
  </div>
  <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <div class="container-fluid">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" href="#">Accueil</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Categories</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Profile</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"> </a>
        </li>
      </ul>
    </div>

    <a href="/users/logout">
      <i
        class="bi bi-box-arrow-in-right"
        style="font-size: 2rem; color: rgb(249, 250, 252); margin-right: 10px"
      ></i
    ></a>
    <br />
  </nav>
</section>

<main class="text-center bg-white">
  <table class="table table-bordered text-black">
    <thead>
      <tr>
        <th>User</th>
        <th>Email</th>
        <th>Type de demande</th>
        <th>Date</th>
        <th>Accept</th>
        <th>Deny</th>
      </tr>
    </thead>
    <tbody class="text-center">
    <% if(typeof allUsers != 'undefined') { %> <% allUsers.forEach(
      function(user) { %> 
        <td class="align-middle"><p><%= user.name %></p></td>
        <td class="align-middle"><p><%= user.email %></p></td>
        <td class="align-middle"><p>Authentication</p></td>
        <td class="align-middle"><p>Date</p></td>
        <td class="align-middle">
          <button class="btn btn-primary" onclick="verifyUser('<%= user.id %>')">Accept</button>
        </td>
        <td class="align-middle">
          <a class="btn btn-secondary" href="#">Deny</a>
        </td>
      </tr>

      <% }) %>
    <% } %>
    </tbody>

  </table>
</main>
<script>
  // Dans un button, onPress="verifyUser(user._id)"
  function verifyUser(id) {
    fetch(`http://127.0.0.1:8000/users/admin/${id}`, {
      method: "POST",
    }).then(() => {
      alert("User approved successfully");
      window.location.reload();
    })
  }
</script>
